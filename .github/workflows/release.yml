name: Release PDF
on:
  push:
    tags:
      - 'v*.*.*'
permissions:
  contents: write
  pull-requests: write
  
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
        - name: Checkout repository
          uses: actions/checkout@v5
        
        - name: Install LaTeX
          run: | 
            sudo apt-get update && sudo apt-get upgrade -y
            sudo apt-get install -y texlive-full
        
        - name: Compile LaTeX document
          run: | 
            latexmk
          working-directory: src
        
        - name: Upload PDF artifact
          uses: actions/upload-artifact@v4
          with:
            name: appunti-latex-pdf
            path: src/build/pdf
        
        - name: Release
          uses: softprops/action-gh-release@v2
          with:
            files: |
                src/build/pdf/*.pdf
                LICENSE.txt